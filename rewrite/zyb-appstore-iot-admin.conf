 location / {
    # 1. 尝试按顺序匹配：URI → URI/ → 进入 fallback 处理
    try_files $uri $uri/ @fallback;
}

# 2. 处理无后缀 PHP 文件和重定向逻辑
location @fallback {
    # 检查是否存在对应的 .php 文件（无后缀访问）
    if (-f $document_root$uri.php) {
        rewrite (.*)$ $1.php last;  # 内部重写到 .php 文件
    }

    # 如果资源不存在，重定向到目标站点
    if (!-e $request_filename) {
        #rewrite /(.*)$ https://iot-admin.zuoyebang.com/$1 permanent;
        rewrite /(.*)$ /proxy/$1 last;
    }
}

location /proxy/ {
    proxy_pass https://iot-admin.zuoyebang.com/;
    proxy_set_header HOST iot-admin.zuoyebang.com;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    internal;
}